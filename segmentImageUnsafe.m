function [BW,maskedImage] = segmentImageUnsafe(X)
% segment for all bodies except background
%segmentImage Segment image using auto-generated code from imageSegmenter app
%  [BW,MASKEDIMAGE] = segmentImage(X) segments image X using auto-generated
%  code from the imageSegmenter app. The final segmentation is returned in
%  BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 10-Jan-2022
%----------------------------------------------------


% Adjust data to span data range.
X = imadjust(X);

% Graph cut
foregroundInd = [877 880 881 882 1385 1388 1394 1396 1892 1894 1895 2395 2396 2398 2399 2401 2403 2421 2422 2904 2905 2906 2907 2935 3412 3414 3415 3449 3924 3962 4476 4478 4479 4480 4482 4557 4559 4561 4996 4998 5065 5264 5265 5266 5268 5513 5515 5519 5575 5782 5783 5784 6035 6037 6083 6550 6551 6810 7065 7067 7069 7099 7100 7103 7584 7605 7606 7607 7609 8115 8611 8613 8614 8615 8618 8620 8623 8625 11259 11771 12283 12284 13307 13819 13820 14333 14335 14336 14848 15355 15358 15489 15490 15492 15493 15494 15495 15496 15498 15867 15869 16009 16010 16011 16384 16513 16514 16516 16523 16524 16894 16896 17023 17026 17028 17029 17036 17037 17038 17535 17538 17542 17548 17550 17551 18045 18050 18054 18055 18056 18060 18064 18430 18556 18563 18568 18569 18571 18572 18577 19068 19075 19076 19454 19579 19588 19589 19590 19591 19592 19593 19594 19601 19602 19966 20091 20101 20102 20103 20114 20216 20217 20218 20478 20603 20615 20620 20626 20723 21115 21129 21132 21136 21137 21240 21627 21642 21643 21645 21646 21647 21648 21738 21741 21742 21745 21746 22139 22155 22253 22255 22261 22652 22654 22666 22667 22760 22776 23168 23169 23178 23271 23609 23610 23612 23613 23616 23618 23621 23689 23801 24122 24195 24196 24197 24198 24199 24200 24297 24634 24823 24824 25148 25151 25152 25154 25156 25158 25319 25661 25671 25807 25809 25811 25812 25814 26175 26184 26317 26328 26329 26330 26332 26343 26688 26689 26690 26691 26693 26694 26695 26696 26825 26828 26844 26855 26867 27337 27368 27847 27868 27883 27884 27886 28356 28357 29379 29404 29888 29889 30910 30940 31420 31452 31931 32442 32953 32988 33975 33976 33989 33992 34486 34497 34499 34506 34508 34524 34998 35009 35010 35020 35509 35522 36021 36043 36044 36060 36533 36554 37065 37084 37558 37575 37596 38072 38073 38083 38109 38586 38589 38592 38622 38893 38896 39136 39137 39402 39411 39912 39924 40163 40436 40470 40471 40473 40475 40476 40480 40483 40936 40948 40981 40982 40990 40992 40993 40994 40996 40997 40998 40999 41190 41448 41449 41460 41494 41690 41691 41692 41693 41695 41698 41962 42001 42006 42018 42023 42202 42213 42214 42215 42474 42475 42476 42477 42481 42483 42510 42518 42534 42535 42727 42990 43031 43044 43227 43532 43545 43546 43553 43555 43741 43751 43752 43753 44014 44043 44044 44060 44062 44064 44256 44260 44262 44264 44526 47718 47719 47720 48230 48234 48742 48748 48749 49262 49263 49777 50289 50782 50783 50785 50786 50788 50789 50791 50792 50793 50801 51293 51803 51817 51818 51825 52182 52185 52186 52188 52314 52315 52331 52332 52337 52693 52694 52696 52699 52701 52702 52826 52844 52849 53203 53338 53357 53714 53725 53726 53727 53850 53872 54226 54237 54382 54751 54876 54879 54894 55250 55261 55394 55397 55399 55401 55404 55405 55764 55771 56789 56792 56794 57614 58126 58655 59152 59653 59657 59913 59915 60068 60163 60174 60178 60180 60425 60428 60576 60577 60579 60580 60581 60582 60584 60675 60690 60695 60937 61097 61098 61449 61450 61451 61453 61454 61456 61603 61604 61610 61702 61705 61710 61713 61714 61963 61964 61965 61967 61969 62116 62117 62122 62233 62476 62477 62480 62482 62630 62631 62632 62633 62989 62993 62994 72123 72126 72129 72130 72632 72633 72634 72637 72639 72641 72642 73142 73143 73144 73153 73154 73654 73656 73665 73955 74166 74680 74688 74689 75192 75193 75201 75704 75705 75713 76219 76220 76221 76222 76223 76225 78318 78321 78324 78325 78839 79341 79342 79343 79351 79511 79851 79853 79856 79863 80362 80363 80368 80371 80374 80874 80875 80883 80885 81260 81387 81395 81535 81537 81538 81544 81772 81896 81899 81906 82061 82284 82408 82412 82417 82559 82920 82922 82925 82926 82928 83073 83076 83079 83081 83087 83088 83306 83308 83311 83313 83435 83438 83586 83595 83596 83597 83818 83820 83826 83827 84097 84098 84107 84108 84326 84332 84333 84337 84339 84609 84613 84616 84617 84619 84836 84847 84849 84851 85120 85348 85639 85860 85868 86373 86375 91164 91165 91167 91168 91169 91170 91171 91172 91173 91174 91175 91675 91689 92184 92185 92186 92201 92202 92203 92695 92716 92997 92999 93003 93206 93509 93715 93716 93718 93741 93742 93743 94021 94032 94227 94255 94546 94737 94768 94820 95058 95248 95280 95281 95327 95559 95570 95572 95574 95575 95577 95758 95760 95794 96270 96306 96307 96600 96781 96819 97051 97098 97106 97293 97332 97552 97613 97622 97805 97845 98317 98357 98641 98643 98644 98829 98869 99341 99381 99593 99853 99893 100365 100404 100405 101389 101428 101901 101911 101912 101913 101914 101915 101939 101940 102414 102415 102421 102423 102428 102451 102933 102935 102937 102938 102941 103440 103445 103447 103452 103455 103475 103952 103957 103960 103961 103966 103968 103987 104464 104479 104498 104977 104982 104988 104989 104991 104992 105010 105489 105522 106002 106003 106515 106516 106544 107029 107030 107056 107542 107568 108055 108568 108569 108570 108571 108572 108573 108574 108575 109787 110173 110174 110175 110177 110179 110180 110684 111196 111205 111707 111718 111720 111721 112234 112729 112747 112867 113260 113752 113772 113773 113884 114262 114286 114771 114772 114773 114798 115220 115289 115290 115310 115311 115732 115733 115800 116247 116312 116335 116756 116824 116847 116848 117273 117336 117360 117782 117848 117872 118296 118298 118361 118384 118896 119321 119322 119324 119386 119408 119834 119838 119840 119899 119900 119919 120353 120354 120413 120429 120928 120929 120932 120934 120938 127937 127938 127940 127942 127944 127945 127947 127948 127949 127950 128355 128359 128448 128462 128463 128464 128978 129491 129492 130005 130007 130519 131031 131032 132056 132568 133080 133592 133623 134104 134134 134135 134326 134329 134330 134331 134332 134333 134334 134531 134532 134533 134534 134535 134536 134537 134538 134541 134542 134544 134545 134546 134547 134616 134646 134648 134649 134847 134848 134849 135049 135051 135159 135348 135362 135363 135565 135566 135618 135620 135621 135623 135671 135672 135674 135857 135858 135875 136129 136135 136136 136183 136186 136387 136881 136899 137153 137161 137208 137209 137210 137394 137408 137409 137411 137412 137665 137673 137722 137907 137908 137910 137911 137914 137916 137917 137918 138177 138697 139201 139207 139209 139713 139719 139721 140231 140737 140738 141251 141252 141253 141254 143828 144340 144851 144852 145353 145355 145357 145359 145361 145865 145866 153700 153701 153702 153703 153706 154220 154724 155237 155246 155758 156262 156782 157283 157284 157285 157288 157293 157796 157799 157803 157804 157805 158310 158312 158826 158829 159339 159340 159341 163364 163876 164388 164391 164393 164902 164907 165419 165929 165930 165931 166408 166439 166443 166920 166952 166955 167433 167434 167467 167948 167978 167979 168974 169489 171025 171537 172561 173073 174096 175631 176143 177164 177165 177166 177660 177676 178172 178173 178188 178684 178685 178702 179196 179210 179708 179709 180219 180220 180222 180732 180744 180748 181245 181246 181255 181758 181767 182269 182270 182279 182282 182376 182781 182782 182791 182884 182885 182886 182887 182888 182889 183293 183294 183303 183395 183396 183400 183816 183906 183908 183912 183913 183914 183916 184327 184420 184424 184427 184428 184933 184935 184937 184946 185349 185448 185450 185458 185861 185960 185970 186472 186481 186984 186985 186988 186990 186991 187308 187310 187312 187813 187815 187816 187817 187820 187826 188323 188334 188341 188832 188849 188854 189344 189362 189366 189856 189874 190369 190386 190390 190890 190891 190892 190899 190902 191161 191393 191402 191405 191414 191665 191667 191906 191914 191917 191918 191925 191926 192173 192176 192181 192183 192186 192187 192427 192430 192436 192676 192678 192680 192682 192683 192684 192685 192699 192931 192942 192943 192945 192947 193187 193196 193210 193211 193444 193454 193460 193461 193462 193584 193586 193587 193697 193698 193957 193970 194096 194100 194208 194219 194469 194470 194478 194479 194608 194613 194729 194734 194735 194736 194982 194984 194987 194988 194989 195125 195230 195248 195497 195499 195632 195638 195741 195752 195760 196015 196018 196144 196251 196272 196531 196656 196657 196663 196762 196775 197176 197274 197286 197287 197294 197787 197802 197803 197804 197805 198200 198299 198314 198317 198318 198319 198812 198813 198826 198827 198828 198829 198831 199325 199344 199736 199838 199857 199919 199920 199921 199922 200147 200150 200153 200157 200351 200369 200429 200430 200657 200673 200676 200864 200871 201272 201376 201384 201386 201452 201681 201703 201888 201898 201964 201967 202205 202216 202220 202410 202479 202705 202717 202732 202733 202734 202735 202922 202986 202989 202990 203217 203229 203230 203241 203248 203434 203498 203501 203729 203744 203763 204010 204011 204257 204276 204457 204521 204523 204756 204769 204789 204968 205030 205032 205270 205281 205479 205541 205784 205787 205790 205792 205793 205814 206051 206328 206561 206563 206724 206725 206726 206727 206728 206730 206732 206733 206734 206735 206737 206738 206840 207014 207071 207072 207232 207235 207353 207583 207615 207744 208038 208092 208093 208095 208127 208128 208378 208640 208641 208751 208754 208756 208890 209154 209268 209403 209664 209772 209773 209780 209782 209915 210084 210177 210179 210180 210284 210285 210296 210427 210640 210795 210796 211146 211147 211148 211152 211153 211155 211202 211206 211307 211308 211309 211321 211451 211658 211660 211661 211662 211820 211823 211963 212170 212175 212180 212227 212230 212345 212475 212502 212503 212687 212692 212741 212742 212857 213014 213015 213195 213199 213204 213253 213254 213358 213369 213499 213709 213765 213766 213872 213873 213881 214035 214227 214278 214388 214391 214523 214550 214684 214689 214734 214735 214736 214737 214738 214790 215035 215059 215201 215203 215204 215206 215207 215208 215302 215303 215570 215714 215715 215716 215718 215719 215813 215815 216059 216082 216216 216231 216323 216325 216327 216573 216727 216787 216788 216839 217085 217108 217239 217254 217300 217346 217350 217619 217751 217813 217856 217857 217859 218109 218128 218263 218272 218273 218274 218275 218326 218357 218364 218367 218369 218640 218776 218777 218873 219152 219291 219293 219301 219302 219350 219376 219378 219379 219380 219382 219383 219391 219645 219664 219665 219808 219809 219811 219813 219901 220158 220176 220375 220411 220688 220727 220728 220732 220733 220734 220736 220738 220739 220887 220912 220914 220915 220917 220919 220921 221182 221239 221240 221244 221252 221694 221753 221756 222263 222268 222278 222423 222425 222719 222780 222791 223231 223287 223293 223303 223805 223815 223961 224255 224312 224326 224831 224986 225337 225347 225850 225851 225852 225853 225856 226010 226522 226880 227546 228160 228161 228162 228164 228167 228168 228570 228673 228680 229194 229594 229699 229700 229703 229706 229707 230106 230219 230618 230939 230941 230944 231130 231449 231642 231959 231971 232471 232485 232666 232983 232998 233178 233495 233509 233510 233689 234006 234007 234009 234201 234518 234519 234521 234522 234524 235030 235037 235044 235225 235543 235551 235680 235681 235682 235737 236067 236193 236196 236569 236578 236707 236710 236711 236761 237083 237219 237220 237224 237524 237525 237528 237734 237784 238108 238109 238111 238112 238247 238295 238296 238554 239067 239572 239573 239574 239575 239578 239581 240596 240603 240606 240843 240844 240845 240847 240852 240853 240854 240855 241117 241118 241355 241364 241367 241620 241630 241867 241872 242132 242141 242142 242379 242385 242391 242653 242654 242875 242876 242878 242897 242903 243157 243390 243391 243404 243405 243409 243414 243675 243906 243918 243921 243926 244184 244431 244433 244435 244437 244697 244698 244932 244945 245210 245958 246470 250986 250987 250988 250990 250991 251497 251498 251503 252009 252017 252520 253032 253042 253543 253557 253558 254055 254071 254584 255079 256102 256122 256614 256635 257638 257660 258150 258172 258662 259174 259685 260764 ];
backgroundInd = [12 251 252 253 254 256 258 525 761 762 763 829 1006 1038 1271 1272 1341 1518 1550 1781 1782 1853 2030 2062 2293 2365 2541 2574 2802 2803 2877 3052 3053 3086 3313 3314 3563 3597 3824 3901 4074 4108 4333 4335 4413 4584 4585 4844 5096 5354 5355 5438 5608 5642 5864 5865 5950 6119 6376 6665 6691 6692 6694 6697 6698 6701 6703 6707 6709 6712 6885 6886 6887 6974 7142 7143 7177 7200 7395 7487 7653 7712 7740 7907 7999 8165 8255 8417 8418 8511 8676 8712 8735 8770 8924 8925 8927 9023 9224 9699 9756 9795 9946 10047 10210 10211 10248 10268 10310 10456 10457 10559 10722 10966 10967 11234 11272 11335 11476 11583 11746 11784 11802 11848 11983 11984 11985 11987 12095 12258 12361 12363 12607 12770 12825 13006 13007 13282 13320 13335 13387 13388 13513 13514 13516 13631 13832 13901 14020 14022 14023 14144 14145 14147 14306 14344 14358 14531 14654 14659 14660 14661 14857 14926 15041 15174 15175 15176 15177 15179 15181 15182 15183 15184 15185 15186 15187 15188 15189 15191 15192 15193 15194 15195 15330 15369 15550 15551 15552 15677 15842 15882 15893 16061 16220 16221 16222 16224 16354 16395 16463 16570 16572 16701 16737 16738 16739 16741 16742 16743 16745 16908 16916 17080 17081 17258 17259 17302 17303 17378 17488 17772 17815 17816 17890 17933 17934 18003 18102 18103 18236 18285 18287 18288 18328 18402 18446 18451 18611 18613 18614 18800 18801 18841 18914 18960 18963 19122 19123 19259 19313 19353 19354 19473 19474 19475 19540 19633 19827 19867 19868 19869 19938 19987 19988 20142 20144 20282 20340 20382 20383 20450 20565 20654 20853 20895 20962 21012 21014 21163 21165 21366 21367 21408 21409 21527 21592 21674 21675 21816 21880 21881 21922 21986 22185 22393 22394 22435 22554 22617 22906 22907 22948 23010 23130 23207 23208 23352 23419 23420 23421 23423 23461 23462 23522 23580 23643 23717 23718 23935 23936 23937 23974 24034 24228 24375 24451 24486 24605 24669 24739 24964 24965 24998 25059 25119 25182 25183 25250 25397 25477 25478 25479 25510 25571 25632 25698 25760 25761 25992 26022 26211 26270 26271 26420 26505 26534 26595 26724 26726 26781 26782 27018 27046 27107 27292 27530 27558 27619 27752 27802 27955 28043 28070 28131 28265 28313 28314 28466 28556 28557 28581 28582 28643 28778 28824 29069 29284 29285 29291 29335 29336 29489 29581 29605 29667 29797 29804 29846 30095 30117 30179 30309 30357 30607 30628 30821 30830 30831 30866 30867 30868 31023 31119 31203 31333 31345 31346 31377 31631 31651 31715 31845 31858 31888 32046 32227 32357 32372 32398 32399 32400 32655 32675 32739 32869 32885 32910 33070 33167 33186 33251 33381 33398 33420 33421 33580 33679 33698 33762 33892 33911 33912 33923 33930 33931 34077 34091 34092 34190 34191 34274 34402 34403 34404 34426 34427 34428 34429 34430 34431 34432 34433 34434 34435 34436 34437 34438 34439 34440 34441 34442 34589 34602 34603 34721 34786 34912 34913 34914 34947 34948 35102 35114 35213 35214 35297 35298 35405 35406 35407 35409 35410 35411 35412 35414 35416 35417 35418 35419 35420 35421 35422 35423 35459 35461 35615 35725 35743 35807 35912 35913 35914 35915 35916 35972 35973 36127 36135 36136 36236 36237 36318 36319 36424 36485 36486 36639 36640 36644 36645 36646 36748 36829 36934 37152 37156 37279 37339 37340 37445 37446 37509 37510 37665 37666 37668 37769 37770 37848 37850 37956 37957 38023 38178 38279 38281 38302 38357 38359 38468 38533 38535 38790 38867 38868 38979 39047 39202 39301 39331 39369 39370 39371 39372 39373 39374 39375 39376 39377 39378 39490 39491 39558 39559 39560 39715 39812 39842 39876 39877 39878 39880 40002 40071 40228 40322 40323 40350 40386 40387 40513 40514 40583 40584 40741 40831 40832 40865 40896 40897 41025 41095 41096 41255 41338 41341 41374 41375 41404 41406 41407 41608 41768 41849 41850 42048 42119 42121 42359 42398 42399 42411 42412 42414 42415 42417 42418 42419 42426 42427 42560 42631 42634 42757 42793 42794 42863 42864 42865 42867 42868 42870 42909 42910 42921 42933 42934 42935 42936 42937 43072 43147 43370 43372 43421 43423 43431 43446 43447 43584 43656 43659 43819 43821 43872 43874 43876 43878 43880 43932 43935 43942 43957 43959 44096 44168 44333 44367 44369 44371 44372 44374 44375 44377 44379 44381 44382 44443 44444 44448 44449 44450 44451 44452 44467 44469 44470 44608 44680 44684 44846 44955 44982 45120 45192 45197 45359 45385 45386 45388 45390 45465 45466 45494 45632 45704 45706 45710 45873 45895 45896 45976 46006 46144 46223 46386 46404 46488 46518 46656 46730 46915 46999 47030 47168 47242 47248 47412 47425 47509 47510 47541 47680 47761 47762 47926 47936 48020 48021 48052 48192 48267 48274 48439 48531 48563 48704 48779 48788 48789 48790 48952 48957 48958 49074 49216 49291 49303 49554 49555 49728 49803 49815 49816 49817 49818 49976 49979 50065 50097 50240 50315 50330 50331 50332 50333 50489 50490 50577 50609 50752 50827 50846 50847 50848 51001 51002 51088 51121 51361 51515 51633 51777 51851 51875 51876 52025 52111 52112 52145 52289 52363 52388 52389 52390 52539 52623 52657 52802 52875 52902 52903 53052 53134 53169 53314 53387 53388 53416 53565 53645 53681 53826 53900 53929 53930 53931 54156 54193 54412 54668 54705 54850 54924 54956 54957 55101 55178 55179 55217 55363 55436 55470 55613 55689 55690 55729 55875 55949 56125 56495 56496 56713 56754 56899 56973 57008 57149 57222 57224 57266 57411 57485 57521 57661 57733 57734 57778 57923 57997 58034 58245 58291 58435 58436 58509 58547 58548 58757 58803 58805 58948 59197 59267 59268 59317 59534 59572 59778 59973 60046 60047 60086 60289 60290 60485 60559 60599 60800 60998 61071 61111 61245 61311 61583 61624 61823 62022 62095 62096 62137 62333 62335 62452 62535 62608 62650 62780 62964 63047 63048 63049 63120 63163 63356 63476 63477 63561 63632 63676 63989 63990 64189 64315 64379 64380 64585 64587 64656 64889 64890 64988 65015 65099 65169 65213 65398 65399 65400 65528 65612 65681 65851 65907 65908 66193 66194 66238 66418 66707 66871 66872 66873 66874 66875 66876 66877 66878 66880 66881 66882 66883 66885 66886 66887 66928 66929 67220 67264 67402 67403 67405 67407 67438 67732 67899 67923 67924 67926 67929 67930 67931 67932 67933 67934 67937 67939 67940 67942 67944 67945 67947 67948 68244 68289 68410 68471 68757 68801 68922 68983 68985 69269 69497 69498 69781 69782 69826 69946 70010 70294 70295 70339 70456 70523 70524 70808 70961 71036 71321 71322 71363 71473 71480 71549 71550 71834 71985 71991 72063 72347 72387 72497 72576 72860 72861 72862 72899 73088 73374 73376 73412 73521 73526 73601 73602 73694 73888 73924 74115 74402 74403 74544 74627 74628 74915 74916 74917 74948 75055 75061 75141 75431 75460 75565 75573 75944 75945 75946 75972 76076 76077 76165 76458 76459 76484 76594 76595 76679 76972 76973 76974 77191 77313 77314 77487 77488 77489 77491 77492 77508 77618 77704 77826 77827 78004 78006 78007 78020 78130 78216 78339 78340 78520 78521 78522 78523 78532 78641 78729 78853 78854 78855 79036 79037 79038 79241 79368 79369 79370 79551 79552 79553 79554 79555 79556 79557 79665 79753 79884 80069 80070 80071 80176 80265 80266 80397 80581 80910 80911 80912 80913 80986 81094 81095 81097 81098 81100 81101 81103 81105 81107 81108 81110 81111 81113 81115 81116 81119 81120 81122 81123 81125 81128 81129 81132 81133 81135 81136 81138 81139 81140 81142 81143 81144 81145 81147 81148 81149 81150 81151 81152 81154 81155 81200 81290 81428 81429 81669 81670 81671 81672 81675 81676 81677 81679 81680 81681 81682 81684 81685 81687 81688 81689 81691 81693 81695 81697 81700 81711 81802 81942 82314 82457 82518 82520 82521 82726 82729 82732 82733 82735 82826 82970 82972 83027 83338 83366 83367 83368 83369 83370 83371 83372 83373 83374 83375 83376 83377 83485 83536 83537 83759 83850 83875 83876 83877 83878 83889 83890 83999 84000 84002 84046 84047 84365 84366 84367 84368 84370 84371 84372 84373 84374 84375 84376 84377 84378 84379 84380 84381 84382 84383 84384 84385 84386 84387 84402 84403 84404 84405 84515 84516 84556 84874 84875 84876 84917 85068 85429 85430 85540 85542 85578 85579 85807 85897 85942 85943 86055 86056 86057 86058 86087 86088 86089 86407 86408 86456 86457 86458 86459 86460 86462 86463 86572 86573 86574 86576 86577 86578 86579 86581 86582 86584 86585 86586 86587 86588 86589 86590 86591 86592 86594 86596 86597 86598 86918 86975 86976 86977 87106 87429 87430 87489 87490 87491 87618 87941 88004 88367 88453 88516 88643 88963 88964 89028 89029 89155 89473 89474 89475 89541 89542 89669 89984 90054 90055 90415 90495 90496 90567 90693 91005 91006 91007 91079 91080 91206 91439 91516 91592 92027 92104 92230 92538 92539 92616 92975 93050 93128 93254 93562 93640 93766 93999 94000 94073 94152 94278 94511 94512 94585 94664 95024 95097 95302 95536 95609 95689 95815 96048 96119 96201 96328 96384 96385 96386 96388 96389 96390 96391 96392 96393 96394 96395 96396 96397 96398 96399 96400 96401 96402 96403 96404 96560 96631 96840 96895 96917 96918 97072 97143 97225 97353 97406 97431 97584 97655 97865 97866 97944 98096 98249 98379 98380 98429 98456 98678 98679 98892 98894 98940 98968 98969 99119 99190 99274 99406 99407 99452 99482 99631 99702 99920 99963 99994 100143 100213 100349 100350 100432 100433 100434 100435 100436 100437 100438 100439 100440 100507 100508 100654 100725 100811 100861 100952 100953 100954 100955 100987 101021 101373 101467 101468 101469 101498 101533 101534 101677 101748 101835 101884 101885 101982 102008 102010 102046 102188 102189 102259 102260 102396 102558 102700 102859 102907 103070 103211 103283 103583 103584 103794 103931 104097 104232 104234 104305 104395 104441 104442 104744 105121 105256 105329 105419 105464 105633 105767 105931 105976 106145 106352 106658 106791 106864 106955 106956 106999 107171 107302 107376 107468 107510 107888 108195 108325 108399 108493 108707 108911 109006 109044 109219 109348 109518 109731 109859 109934 110030 110066 110067 110370 110445 110755 110882 111055 111268 111393 111469 111567 111599 111600 111673 111780 111903 111904 111981 112079 112185 112292 112414 112493 112592 112804 112925 113005 113104 113209 113316 113436 113517 113617 113721 113828 113947 114029 114129 114340 114641 114745 114852 114969 115053 115068 115069 115071 115072 115073 115074 115153 115156 115157 115159 115160 115161 115162 115163 115164 115165 115166 115167 115257 115364 115479 115481 115565 115580 115586 115587 115663 115664 115665 115666 115674 115675 115676 115677 115678 115679 115681 115683 115684 115685 115688 115690 115693 115696 115699 115701 115704 115707 115708 115876 116092 116099 116100 116174 116175 116281 116388 116502 116604 116613 116684 116685 116686 116793 117013 117086 117087 117088 117089 117090 117091 117092 117094 117095 117096 117097 117098 117099 117100 117101 117107 117116 117125 117126 117127 117193 117194 117195 117497 117498 117499 117500 117502 117503 117504 117506 117507 117509 117511 117512 117513 117523 117597 117598 117613 117614 117615 117616 117617 117619 117628 117640 117641 117642 117645 117648 117704 117705 117817 118005 118006 118007 118008 118025 118026 118034 118107 118108 118109 118130 118131 118132 118133 118134 118135 118136 118137 118138 118139 118140 118163 118165 118169 118209 118210 118211 118212 118213 118214 118215 118329 118421 118423 118424 118425 118426 118427 118428 118516 118517 118539 118617 118618 118643 118684 118714 118716 118718 118719 118841 118932 118941 118942 119027 119055 119155 119198 119353 119442 119443 119444 119455 119456 119457 119459 119539 119563 119564 119566 119638 119640 119666 119712 119715 119716 119718 119720 119721 119723 119724 119725 119726 119727 119728 119729 119730 119732 119733 119734 119735 119736 119865 119954 119972 119974 120050 120076 120077 120078 120079 120148 120149 120377 120465 120487 120488 120562 120587 120591 120592 120659 120976 121001 121002 121003 121004 121005 121006 121008 121074 121099 121106 121170 121171 121202 121488 121521 121523 121524 121526 121527 121530 121532 121618 121713 122046 122048 122050 122098 122132 122193 122511 122564 122566 122568 122610 122644 122645 122697 122698 122703 122704 122737 123022 123082 123083 123120 123121 123158 123159 123210 123211 123212 123214 123534 123597 123599 123632 123671 123722 123723 124046 124112 124115 124143 124183 124234 124235 124272 124558 124628 124631 124653 124696 124745 124747 125070 125164 125165 125209 125211 125255 125256 125261 125582 125656 125675 125723 126094 126169 126186 126236 126277 126278 126286 126319 126320 126606 126684 126685 126748 126750 126789 126798 127118 127209 127263 127264 127300 127630 127720 127777 127778 127810 127823 127824 127855 128142 128223 128230 128290 128291 128321 128654 128736 128804 128848 128877 129166 129254 129317 129362 129389 129678 129762 129764 129765 129830 129831 129832 129845 129846 129856 129875 129900 129901 130190 130276 130344 130357 130387 130411 130412 130702 130787 130858 130859 130868 130878 130900 130922 131214 131299 131301 131371 131372 131378 131380 131413 131433 131434 131727 131813 131884 131885 131901 131926 131945 132239 132322 132326 132397 132398 132399 132400 132401 132402 132439 132441 132457 132751 132752 132834 132923 132954 132968 133264 133352 133432 133468 133480 133776 133857 133858 133982 133992 134288 134369 134377 134455 134496 134800 134881 134966 135015 135393 135401 135522 135824 135905 135914 135989 136035 136038 136417 136500 136848 136938 137011 137061 137361 137440 137451 137522 137523 137524 137574 137873 137874 137952 137964 138031 138033 138037 138085 138386 138464 138542 138898 138975 138988 139053 139061 139107 139410 139500 139563 139564 139575 139619 140073 140130 140434 140511 140525 140583 140584 140600 140641 140947 141023 141092 141094 141152 141153 141460 141535 141549 141625 141664 141972 142115 142174 142176 142484 142559 142573 142626 142650 142685 142686 142997 143163 143509 143583 143597 143648 143649 143676 143707 143708 144022 144189 144217 144218 144534 144671 144729 145046 145119 145133 145182 145214 145238 145239 145491 145559 145693 145726 145748 146003 146071 146239 146259 146512 146514 146583 146654 146716 146752 146753 146770 147024 147095 147281 147457 147535 147738 147777 147790 147969 148046 148047 148119 148189 148205 148290 148483 148484 148558 148632 148760 148803 148813 148996 149069 149070 149213 149320 149321 149322 149508 149580 149829 150021 150091 150092 150237 150294 150341 150534 150603 150765 150854 151032 151047 151048 151049 151113 151114 151367 151544 151545 151561 151562 151563 151564 151625 151773 151829 151880 152057 152058 152077 152078 152136 152392 152570 152590 152591 152646 152797 152851 152905 153082 153104 153157 153418 153593 153594 153616 153618 153619 153620 153667 153668 153673 153820 153931 154105 154132 154133 154178 154185 154385 154443 154616 154646 154647 154648 154649 154650 154652 154653 154654 154655 154656 154657 154658 154659 154660 154662 154663 154665 154666 154667 154668 154669 154670 154671 154672 154674 154675 154676 154677 154678 154680 154681 154682 154683 154684 154685 154686 154687 154688 154689 154697 154844 154895 154957 155209 155355 155373 155406 155469 155640 155721 155865 155916 156152 156233 156376 156381 156383 156386 156387 156427 156494 156496 156664 156887 156899 156937 157176 157257 157399 157402 157414 157449 157688 157770 157913 157926 157957 157958 158032 158200 158460 158462 158464 158466 158545 158711 158795 158934 158951 158970 159223 159307 159439 159440 159441 159443 159444 159464 159480 159571 159735 159820 159932 159933 159935 159936 159937 159938 159939 159940 159942 159943 159945 159946 159948 159949 159950 159951 159976 159981 159989 159990 160444 160489 160496 160498 160596 160686 160759 160845 160956 161110 161198 161270 161358 161468 161514 161515 161517 161710 161782 161871 161980 162026 162135 162138 162220 162221 162294 162383 162492 162647 162650 162731 162896 163005 163048 163160 163162 163241 163318 163410 163518 163555 163565 163672 163674 163752 163829 163922 164075 164188 164434 164544 164578 164702 164774 164852 164947 165000 165001 165002 165003 165005 165006 165007 165008 165009 165010 165057 165089 165217 165219 165221 165223 165285 165459 165510 165511 165522 165523 165571 165611 165795 165876 165972 166021 166036 166112 166123 166250 166252 166253 166305 166387 166484 166485 166530 166531 166532 166548 166549 166596 166597 166637 166768 166770 166773 166774 166899 166997 166998 166999 167041 167287 167289 167290 167291 167293 167295 167326 167333 167334 167410 167511 167512 167551 167552 167553 167622 167647 167658 167808 167809 167810 167846 167847 167848 167849 167851 167922 168024 168025 168062 168063 168136 168159 168323 168325 168348 168364 168365 168366 168433 168537 168650 168838 168840 168841 168944 169049 169051 169052 169053 169083 169084 169162 169163 169183 169194 169197 169353 169354 169368 169392 169393 169456 169566 169567 169594 169595 169677 169678 169695 169866 169868 169869 169906 169908 169966 170081 170106 170216 170221 170381 170421 170593 170615 170616 170617 170704 170901 170936 170990 171105 171106 171125 171126 171216 171218 171231 171240 171242 171245 171449 171501 171590 171618 171619 171620 171621 171622 171623 171624 171625 171626 171627 171628 171629 171630 171631 171632 171633 171634 171635 171636 171637 171730 171731 171750 171751 171753 171754 171757 171921 171963 172012 172103 172264 172476 172615 172755 172767 172774 172775 172943 172988 173036 173127 173267 173286 173502 173503 173546 173547 173639 173797 173965 174058 174151 174292 174305 174306 174307 174476 174529 174569 174663 174805 174813 174814 174815 174816 174986 174987 175043 175044 175175 175317 175318 175324 175325 175592 175687 175831 175833 175834 175835 175839 176008 176009 176070 176073 176197 176343 176344 176518 176587 176614 176854 176855 177101 177125 177360 177361 177362 177363 177364 177375 177541 177615 177618 177634 177635 177636 177730 177731 177865 177866 177869 177871 177887 178050 178052 178132 178145 178371 178373 178375 178399 178403 178404 178561 178655 178656 178657 178753 178879 178880 178916 178917 178918 179072 179159 179262 179263 179386 179388 179389 179430 179583 179674 179773 179896 179897 179944 180095 180284 180406 180456 180457 180604 180605 180701 180702 180793 180794 180916 180970 180971 180972 181115 181304 181427 181485 181486 181626 181813 181815 181936 181937 181999 182138 182242 182445 182446 182447 182512 182514 182647 182648 182954 182955 182956 183027 183028 183030 183158 183159 183269 183544 183545 183669 183782 183783 183965 183966 183968 183969 183970 183971 183972 183974 183975 183976 184058 184059 184060 184062 184180 184472 184474 184476 184574 184576 184690 184691 184983 185088 185089 185090 185201 185490 185492 185493 185605 185606 185712 186120 186122 186224 187149 187246 187664 187668 187756 188182 188697 188777 188779 189214 189799 190241 190311 190757 190820 190822 191273 191332 191788 192302 192303 192353 192355 192865 193331 193334 193374 193375 193848 193884 193885 194072 194073 194075 194076 194077 194078 194079 194080 194363 194394 194592 194878 194880 194905 195094 195104 195105 195394 195396 195412 195413 195414 195416 195617 195910 195911 195914 195915 195917 195918 195919 195921 195923 196130 196627 196628 196642 197154 198162 198179 198691 199184 199204 199716 200206 200228 201254 201741 201766 201767 202765 202791 202793 203788 203817 204300 204330 204842 205867 206119 206380 206631 206892 207405 207918 208165 208431 208676 208943 209455 209698 209967 210990 211233 211744 212013 213279 214060 214814 215083 216350 216618 217130 217373 217715 218227 218396 218664 219251 219419 219687 220786 220955 222491 222832 223170 223171 223172 223173 223174 223175 223176 223177 223179 223180 223181 223183 223185 223186 223188 223189 223191 223192 223194 223195 223197 223679 223680 223681 224026 224190 224191 224222 224224 224225 224226 224228 224229 224230 224538 224700 224701 224702 224743 224745 224746 224747 224749 225212 225261 225262 225561 225724 225774 225775 225776 225902 226073 226236 226413 226585 226747 227097 227259 227771 228120 228282 229144 229483 229656 229818 230680 230842 231193 231353 231705 232039 232218 232377 232731 233401 233755 233756 234269 234270 234425 234782 234937 235295 235448 235620 235807 235958 235959 235960 236320 236833 236979 236981 237346 237348 237489 238000 238176 238374 238887 238888 239023 239400 239401 239403 239404 239710 239917 240044 240429 240941 240942 240943 240944 240945 240946 241065 241067 241458 241754 242600 243110 243286 243620 243621 244130 244818 244819 244870 245152 245153 245383 245619 245620 245621 245622 245624 245625 245626 245629 245631 245661 245663 246172 246352 246408 246641 246657 246658 246683 246922 247151 247171 247191 247192 247373 247435 247684 247685 247687 247702 248174 248199 248201 248203 248205 248207 248208 248210 248211 248395 248460 248684 249412 249414 249416 249707 249904 249906 249908 249910 249912 249913 249915 249917 249919 249920 249922 249923 250218 250412 250415 250510 250730 250922 251942 252450 252586 252959 253098 253469 253612 253614 253978 254486 254488 254640 254642 254994 254995 254996 255155 255156 255505 255669 255670 256016 256182 256183 256184 256524 256525 257034 257035 257545 ];
L = superpixels(X,1463);
BW = lazysnapping(X,L,foregroundInd,backgroundInd);

% Draw ROIs

xPos = [157.4692 157.3702 157.0760 156.5956 155.9436 155.1399 154.2088 153.1786 152.0807 150.9483 149.8160 148.7180 147.6879 146.7567 145.9530 145.3010 144.8206 144.5265 144.4274 144.5265 144.8206 145.3010 145.9530 146.7567 147.6879 148.7180 149.8160 150.9483 152.0807 153.1786 154.2088 155.1399 155.9436 156.5956 157.0760 157.3702 157.4692];
yPos = [412.8949 414.0272 415.1252 416.1554 417.0865 417.8902 418.5422 419.0226 419.3167 419.4158 419.3167 419.0226 418.5422 417.8902 417.0865 416.1554 415.1252 414.0272 412.8949 411.7625 410.6646 409.6344 408.7033 407.8996 407.2476 406.7672 406.4730 406.3740 406.4730 406.7672 407.2476 407.8996 408.7033 409.6344 410.6646 411.7625 412.8949];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

% Flood fill
row = 457;
column = 60;
tolerance = 1.275000e+01;
addedRegion = grayconnected(X, row, column, tolerance);
BW = BW | addedRegion;

% Flood fill
row = 477;
column = 83;
tolerance = 1.275000e+01;
weightImage = graydiffweight(X, column, row, 'GrayDifferenceCutoff', tolerance);
addedRegion = imsegfmm(weightImage, column, row, 0.01);
BW = BW | addedRegion;

% Flood fill
row = 199;
column = 185;
tolerance = 1.275000e+01;
weightImage = graydiffweight(X, column, row, 'GrayDifferenceCutoff', tolerance);
addedRegion = imsegfmm(weightImage, column, row, 0.01);
BW = BW | addedRegion;

% Close mask with octagon
radius = 6;
se = strel('octagon', radius);
BW = imclose(BW, se);

% Create masked image.
maskedImage = X;
maskedImage(~BW) = 0;
end

